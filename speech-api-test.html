<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Web Speech API í…ŒìŠ¤íŠ¸</title>
    <style>
      body {
        font-family: "Arial", sans-serif;
        max-width: 800px;
        margin: 50px auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .test-section {
        margin: 20px 0;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
      }
      button {
        padding: 12px 24px;
        margin: 5px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        background-color: #6c757d;
        color: white;
        transition: all 0.2s ease;
      }
      button:hover {
        background-color: #495057;
        transform: translateY(-1px);
      }
      button:active {
        transform: translateY(0px);
      }
      .control-btn-group {
        display: flex;
        gap: 4px;
        margin: 15px 0;
        justify-content: flex-start;
      }
      .start-btn {
        background-color: #4caf50;
        color: white;
        min-width: 70px;
        max-width: 80px;
        font-size: 13px;
        padding: 8px 12px;
        white-space: nowrap;
        transition: all 0.2s ease;
      }
      .start-btn:hover {
        background-color: #45a049 !important;
        transform: translateY(-1px);
      }
      .start-btn:active {
        transform: translateY(0px);
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
      }
      .stop-btn {
        background-color: #f44336;
        color: white;
        min-width: 70px;
        max-width: 80px;
        font-size: 13px;
        padding: 8px 12px;
        white-space: nowrap;
        transition: all 0.2s ease;
      }
      .stop-btn:hover {
        background-color: #da190b !important;
        transform: translateY(-1px);
      }
      .stop-btn:active {
        transform: translateY(0px);
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
      }
      .lang-btn-group {
        display: flex;
        flex-wrap: nowrap;
        gap: 4px;
        margin: 15px 0;
        padding: 8px;
        background-color: #f8f9fa;
        border-radius: 8px;
        border: 1px solid #e9ecef;
        overflow-x: auto; /* ëª¨ë°”ì¼ì—ì„œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥ */
      }
      .lang-btn {
        background-color: #6c757d;
        color: white;
        border: 2px solid transparent;
        transition: all 0.2s ease;
        min-width: 70px;
        max-width: 80px;
        font-size: 13px;
        padding: 8px 12px;
        white-space: nowrap;
        flex-shrink: 0; /* ë²„íŠ¼ í¬ê¸° ê³ ì • */
      }
      .lang-btn:hover {
        background-color: #495057;
        transform: translateY(-1px);
      }
      .lang-btn.active {
        background-color: #28a745;
        border-color: #20c997;
        box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.25);
      }
      .result {
        margin: 15px 0;
        padding: 15px;
        background-color: #f8f9fa;
        border-radius: 5px;
        min-height: 50px;
      }
      .interim {
        color: #666;
        font-style: italic;
      }
      .final {
        color: #333;
        font-weight: bold;
      }
      .status {
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
      }
      .status.listening {
        background-color: #d4edda;
        color: #155724;
      }
      .status.stopped {
        background-color: #f8d7da;
        color: #721c24;
      }
      .language-info {
        background-color: #e7f3ff;
        padding: 10px;
        border-radius: 5px;
        margin: 10px 0;
      }
      .quality-metrics {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 10px;
        margin: 15px 0;
      }
      .metric {
        background-color: #f1f3f4;
        padding: 10px;
        border-radius: 5px;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ¤ Web Speech API í’ˆì§ˆ í…ŒìŠ¤íŠ¸</h1>

      <!-- ë¸Œë¼ìš°ì € ì§€ì› í™•ì¸ -->
      <div class="test-section">
        <h2>ğŸ” ë¸Œë¼ìš°ì € ì§€ì› í˜„í™©</h2>
        <div id="browser-support"></div>
      </div>

      <!-- ì–¸ì–´ ì„ íƒ -->
      <div class="test-section">
        <h2>ğŸŒ ì–¸ì–´ ì„ íƒ</h2>
        <div class="lang-btn-group">
          <button
            class="lang-btn active"
            onclick="setLanguage('auto')"
            id="btn-auto"
          >
            ğŸ” ìë™
          </button>
          <button
            class="lang-btn"
            onclick="setLanguage('ko-KR')"
            id="btn-ko-KR"
          >
            ğŸ‡°ğŸ‡· í•œêµ­ì–´
          </button>
          <button
            class="lang-btn"
            onclick="setLanguage('en-US')"
            id="btn-en-US"
          >
            ğŸ‡ºğŸ‡¸ ì˜ì–´
          </button>
          <button
            class="lang-btn"
            onclick="setLanguage('ja-JP')"
            id="btn-ja-JP"
          >
            ğŸ‡¯ğŸ‡µ ì¼ë³¸ì–´
          </button>
          <button
            class="lang-btn"
            onclick="setLanguage('zh-CN')"
            id="btn-zh-CN"
          >
            ğŸ‡¨ğŸ‡³ ì¤‘êµ­ì–´
          </button>
        </div>
        <div class="language-info" id="current-language">
          í˜„ì¬ ì–¸ì–´: <span id="lang-display">auto</span>
        </div>
      </div>

      <!-- ìŒì„± ì¸ì‹ í…ŒìŠ¤íŠ¸ -->
      <div class="test-section">
        <h2>ğŸ¯ ìŒì„± ì¸ì‹ í…ŒìŠ¤íŠ¸</h2>
        <div class="control-btn-group">
          <button class="start-btn" onclick="startRecognition()">
            ğŸ¤ ì‹œì‘
          </button>
          <button class="stop-btn" onclick="stopRecognition()">â¹ï¸ ì •ì§€</button>
        </div>

        <div class="status" id="status">ì¤€ë¹„ë¨</div>

        <div class="result">
          <div id="interim-result" class="interim"></div>
          <div id="final-result" class="final"></div>
        </div>
      </div>

      <!-- í’ˆì§ˆ ë©”íŠ¸ë¦­ -->
      <div class="test-section">
        <h2>ğŸ“Š í’ˆì§ˆ ë©”íŠ¸ë¦­</h2>
        <div class="quality-metrics">
          <div class="metric">
            <div>ì¸ì‹ ì†ë„</div>
            <div id="speed">-</div>
          </div>
          <div class="metric">
            <div>ì‹ ë¢°ë„</div>
            <div id="confidence">-</div>
          </div>
          <div class="metric">
            <div>í’ˆì§ˆ ì ìˆ˜</div>
            <div id="quality-score">-</div>
          </div>
          <div class="metric">
            <div>ì–¸ì–´ ê°ì§€</div>
            <div id="detected-lang">-</div>
          </div>
          <div class="metric">
            <div>ì„¸ì…˜ ì‹œê°„</div>
            <div id="total-time">-</div>
          </div>
        </div>
      </div>

      <!-- í…ŒìŠ¤íŠ¸ ë¡œê·¸ -->
      <div class="test-section">
        <h2>ğŸ“ í…ŒìŠ¤íŠ¸ ë¡œê·¸</h2>
        <div
          id="test-log"
          style="
            max-height: 300px;
            overflow-y: auto;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
          "
        ></div>
        <button onclick="clearLog()">ë¡œê·¸ ì§€ìš°ê¸°</button>
      </div>
    </div>

    <script>
      let recognition = null;
      let currentLanguage = "auto";
      let startTime = null;
      let totalRecognitionTime = 0;
      let sessionStartTime = null;

      // ë¸Œë¼ìš°ì € ì§€ì› í™•ì¸
      function checkBrowserSupport() {
        const supportDiv = document.getElementById("browser-support");

        if (
          "webkitSpeechRecognition" in window ||
          "SpeechRecognition" in window
        ) {
          const SpeechRecognition =
            window.SpeechRecognition || window.webkitSpeechRecognition;
          supportDiv.innerHTML = `
                    <div style="color: green;">âœ… Web Speech API ì§€ì›ë¨</div>
                    <div>ì‚¬ìš© ê°€ëŠ¥í•œ API: ${
                      window.SpeechRecognition
                        ? "SpeechRecognition"
                        : "webkitSpeechRecognition"
                    }</div>
                    <div>User Agent: ${navigator.userAgent}</div>
                `;
          return true;
        } else {
          supportDiv.innerHTML = `
                    <div style="color: red;">âŒ Web Speech API ë¯¸ì§€ì›</div>
                    <div>ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>
                `;
          return false;
        }
      }

      // ì–¸ì–´ ì„¤ì •
      function setLanguage(lang) {
        currentLanguage = lang;
        document.getElementById("lang-display").textContent = lang;
        log(`ì–¸ì–´ ë³€ê²½: ${lang}`);

        // ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
        document.querySelectorAll(".lang-btn").forEach((btn) => {
          btn.classList.remove("active");
        });
        document.getElementById(`btn-${lang}`).classList.add("active");
      }

      // ìŒì„± ì¸ì‹ ì‹œì‘
      function startRecognition() {
        console.log("ğŸš€ [DEBUG] startRecognition í•¨ìˆ˜ í˜¸ì¶œë¨");

        if (!checkBrowserSupport()) {
          console.error("âŒ [ERROR] ë¸Œë¼ìš°ì € ì§€ì› í™•ì¸ ì‹¤íŒ¨");
          alert("ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
          return;
        }

        console.log("âœ… [DEBUG] ë¸Œë¼ìš°ì € ì§€ì› í™•ì¸ë¨");

        const SpeechRecognition =
          window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();

        // í–¥ìƒëœ ì„¤ì •
        recognition.continuous = true;
        recognition.interimResults = true;
        recognition.maxAlternatives = 5; // ë” ë§ì€ ëŒ€ì•ˆ ì œê³µ

        // ì–¸ì–´ë³„ ìµœì í™” ì„¤ì •
        if (currentLanguage !== "auto") {
          recognition.lang = currentLanguage;
        } else {
          // ìë™ê°ì§€ ëª¨ë“œì—ì„œëŠ” í•œêµ­ì–´ ìš°ì„  ì„¤ì • (í•œêµ­ ì‚¬ìš©ì ê¸°ì¤€)
          recognition.lang = "ko-KR";
        }

        // ì¶”ê°€ í’ˆì§ˆ í–¥ìƒ ì„¤ì • (ë¸Œë¼ìš°ì €ë³„ ì§€ì›)
        if (recognition.serviceURI) {
          // Google ìŒì„± ì„œë¹„ìŠ¤ ì‚¬ìš© ì‹œ í’ˆì§ˆ í–¥ìƒ
          recognition.serviceURI =
            "wss://www.google.com/speech-api/v2/recognize";
        }

        // ì†ŒìŒ ì œê±° ì„¤ì • (ì§€ì›í•˜ëŠ” ë¸Œë¼ìš°ì €ì—ì„œ)
        try {
          if (typeof recognition.grammars !== "undefined") {
            // ë¹ˆ SpeechGrammarList ìƒì„± (ë¬¸ë²• ì œì•½ í•´ì œ)
            const SpeechGrammarList =
              window.SpeechGrammarList || window.webkitSpeechGrammarList;
            if (SpeechGrammarList) {
              recognition.grammars = new SpeechGrammarList();
              console.log("âœ… [DEBUG] ë¹ˆ Grammar List ì„¤ì • ì™„ë£Œ");
            }
          }
        } catch (error) {
          console.log("âš ï¸ [DEBUG] Grammar ì„¤ì • ìŠ¤í‚µ:", error.message);
        }

        startTime = Date.now();
        if (!sessionStartTime) {
          sessionStartTime = Date.now();
        }

        // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        recognition.onstart = () => {
          document.getElementById("status").className = "status listening";
          document.getElementById("status").textContent = "ğŸ¤ ë“£ê³  ìˆìŠµë‹ˆë‹¤...";
          log("ìŒì„± ì¸ì‹ ì‹œì‘ë¨");
        };

        recognition.onresult = (event) => {
          let interimTranscript = "";
          let finalTranscript = "";

          for (let i = event.resultIndex; i < event.results.length; i++) {
            const result = event.results[i];
            const transcript = result[0].transcript;
            const confidence = result[0].confidence;

            if (result.isFinal) {
              finalTranscript += transcript + " ";

              // í’ˆì§ˆ ë©”íŠ¸ë¦­ ì—…ë°ì´íŠ¸
              const elapsed = Date.now() - startTime;
              document.getElementById("speed").textContent = `${Math.round(
                elapsed,
              )}ms`;
              document.getElementById("confidence").textContent = confidence
                ? `${Math.round(confidence * 100)}%`
                : "ì •ë³´ ì—†ìŒ";

              // í’ˆì§ˆ ì ìˆ˜ ê³„ì‚° (ì†ë„ + ì‹ ë¢°ë„ + í…ìŠ¤íŠ¸ ê¸¸ì´ ê³ ë ¤)
              const qualityScore = calculateQualityScore(
                elapsed,
                confidence,
                transcript.length,
              );
              document.getElementById(
                "quality-score",
              ).textContent = `${qualityScore}/100`;

              // ì–¸ì–´ ê°ì§€ ê°œì„ 
              let detectedLang = "ì •ë³´ ì—†ìŒ";

              if (currentLanguage === "auto") {
                // ìë™ê°ì§€ ëª¨ë“œì¸ ê²½ìš° í…ìŠ¤íŠ¸ ë¶„ì„ìœ¼ë¡œ ì–¸ì–´ ì¶”ì •
                detectedLang = detectLanguageFromText(transcript);
              } else if (recognition.lang) {
                detectedLang = recognition.lang;
              }

              document.getElementById("detected-lang").textContent =
                detectedLang;

              log(
                `ìµœì¢… ê²°ê³¼: "${transcript}" (ì‹ ë¢°ë„: ${
                  confidence ? Math.round(confidence * 100) : "?"
                }%)`,
              );
            } else {
              interimTranscript += transcript;
            }
          }

          document.getElementById("interim-result").textContent =
            interimTranscript;
          document.getElementById("final-result").textContent +=
            finalTranscript;
        };

        recognition.onerror = (event) => {
          log(
            `ì˜¤ë¥˜ ë°œìƒ: ${event.error} - ${event.message || "ìƒì„¸ ì •ë³´ ì—†ìŒ"}`,
          );
          document.getElementById("status").className = "status stopped";
          document.getElementById(
            "status",
          ).textContent = `âŒ ì˜¤ë¥˜: ${event.error}`;
        };

        recognition.onend = () => {
          if (startTime) {
            totalRecognitionTime += Date.now() - startTime;
          }

          // ì´ ì„¸ì…˜ ì‹œê°„ ì—…ë°ì´íŠ¸
          if (sessionStartTime) {
            const totalSessionTime = Date.now() - sessionStartTime;
            document.getElementById(
              "total-time",
            ).textContent = `ì„¸ì…˜: ${Math.round(
              totalSessionTime / 1000,
            )}ì´ˆ | ì¸ì‹: ${Math.round(totalRecognitionTime / 1000)}ì´ˆ`;
          }

          document.getElementById("status").className = "status stopped";
          document.getElementById("status").textContent = "â¹ï¸ ì •ì§€ë¨";
          log("ìŒì„± ì¸ì‹ ì¢…ë£Œë¨");
        };

        recognition.start();
      }

      // ìŒì„± ì¸ì‹ ì •ì§€
      function stopRecognition() {
        console.log("â¹ï¸ [DEBUG] stopRecognition í•¨ìˆ˜ í˜¸ì¶œë¨");

        if (recognition) {
          console.log("âœ… [DEBUG] ì¸ì‹ ê°ì²´ ì¡´ì¬, ì •ì§€ ì¤‘...");
          recognition.stop();
          recognition = null;
          console.log("âœ… [DEBUG] ì¸ì‹ ì •ì§€ ì™„ë£Œ");
        } else {
          console.log("âš ï¸ [DEBUG] ì¸ì‹ ê°ì²´ê°€ ì—†ìŒ");
        }
      }

      // ë¡œê·¸ ê¸°ëŠ¥
      function log(message) {
        const timestamp = new Date().toLocaleTimeString();
        const logDiv = document.getElementById("test-log");
        logDiv.innerHTML += `<div>[${timestamp}] ${message}</div>`;
        logDiv.scrollTop = logDiv.scrollHeight;
      }

      // í–¥ìƒëœ í…ìŠ¤íŠ¸ ê¸°ë°˜ ì–¸ì–´ ê°ì§€
      function detectLanguageFromText(text) {
        if (!text || text.trim().length < 2) return "ì •ë³´ ì—†ìŒ";

        const cleanText = text.trim().toLowerCase();
        let scores = {
          korean: 0,
          japanese: 0,
          chinese: 0,
          english: 0,
        };

        // í•œêµ­ì–´ ê°ì§€ (ê°œì„ ëœ íŒ¨í„´)
        const koreanPatterns = [
          /[ê°€-í£]/g, // ì™„ì„±ëœ í•œê¸€
          /[ã„±-ã…ã…-ã…£]/g, // ììŒ, ëª¨ìŒ
          /\s+(ì€|ëŠ”|ì´|ê°€|ì„|ë¥¼|ì—|ì—ì„œ|ì™€|ê³¼|ì˜|ë„|ë§Œ|ë¶€í„°|ê¹Œì§€|ì—ê²Œ|í•œí…Œ)\s+/g, // ì¡°ì‚¬
          /(ì…ë‹ˆë‹¤|ìŠµë‹ˆë‹¤|í•´ìš”|ì–´ìš”|ì´ì—ìš”|ì˜ˆìš”)$/g, // ì–´ë¯¸
          /(ì•ˆë…•|ê°ì‚¬|ì£„ì†¡|ë¯¸ì•ˆ|ì‚¬ë‘)/g, // í•œêµ­ì–´ íŠ¹ì§• ë‹¨ì–´
        ];

        koreanPatterns.forEach((pattern) => {
          const matches = cleanText.match(pattern);
          if (matches) scores.korean += matches.length * 2;
        });

        // ì¼ë³¸ì–´ ê°ì§€ (ê°œì„ ëœ íŒ¨í„´)
        const japanesePatterns = [
          /[ã²ã‚‰ãŒãª]/g, // íˆë¼ê°€ë‚˜
          /[ã‚«ã‚¿ã‚«ãƒŠ]/g, // ì¹´íƒ€ì¹´ë‚˜
          /[ä¸€-é¾¯]/g, // í•œì (ì¼ë³¸ì–´ìš©)
          /(ã§ã™|ã¾ã™|ã—ãŸ|ã£ã¦|ã¨ã„ã†|ã‚ã‚‹|ã™ã‚‹|ã„ã‚‹|ãªã‚‹)/g, // ì¼ë³¸ì–´ íŠ¹ì§• í‘œí˜„
          /(ã“ã‚“ã«ã¡|ã‚ã‚ŠãŒã¨|ã™ã¿ã¾ã›ã‚“|ã¯ã˜ã‚ã¾ã—ã¦)/g, // ì¼ë³¸ì–´ ì¸ì‚¬ë§
        ];

        japanesePatterns.forEach((pattern) => {
          const matches = cleanText.match(pattern);
          if (matches) scores.japanese += matches.length * 2;
        });

        // ì¤‘êµ­ì–´ ê°ì§€ (ê°œì„ ëœ íŒ¨í„´)
        const chinesePatterns = [
          /[\u4e00-\u9fff]/g, // ì¤‘êµ­ì–´ í•œì
          /(ä½ å¥½|è°¢è°¢|å¯¹ä¸èµ·|å†è§|è¯·é—®|æ²¡å…³ç³»|ä¸å®¢æ°”)/g, // ì¤‘êµ­ì–´ ì¸ì‚¬ë§
          /(çš„|äº†|æ˜¯|åœ¨|æœ‰|å’Œ|ä¹Ÿ|éƒ½|ä¼š|è¦|å¯ä»¥)/g, // ì¤‘êµ­ì–´ íŠ¹ì§• ë‹¨ì–´
          /(ä»€ä¹ˆ|æ€ä¹ˆ|å“ªé‡Œ|ä¸ºä»€ä¹ˆ|å¤šå°‘)/g, // ì˜ë¬¸ì‚¬
        ];

        chinesePatterns.forEach((pattern) => {
          const matches = cleanText.match(pattern);
          if (matches) scores.chinese += matches.length * 2;
        });

        // ì˜ì–´ ê°ì§€ (ê°œì„ ëœ íŒ¨í„´)
        const englishPatterns = [
          /\b[a-z]+\b/g, // ì˜ë¬¸ ë‹¨ì–´
          /\b(the|is|are|and|or|but|in|on|at|to|for|of|with|by)\b/g, // ê´€ì‚¬/ì „ì¹˜ì‚¬
          /\b(hello|thank|sorry|please|welcome|good|nice|how|what|where|when|why)\b/g, // ì˜ì–´ ì¸ì‚¬ë§/ì˜ë¬¸ì‚¬
          /\b(going|doing|being|having|getting|making|taking|coming)\b/g, // ì§„í–‰í˜•/ë™ëª…ì‚¬
        ];

        englishPatterns.forEach((pattern) => {
          const matches = cleanText.match(pattern);
          if (matches) scores.english += matches.length;
        });

        // ì ìˆ˜ ê¸°ë°˜ ì–¸ì–´ íŒì •
        const maxScore = Math.max(...Object.values(scores));
        if (maxScore === 0) return "ì •ë³´ ì—†ìŒ";

        // ì‹ ë¢°ë„ ê³„ì‚° (ìµœê³ ì ìˆ˜ / ì´ì ìˆ˜)
        const totalScore = Object.values(scores).reduce((a, b) => a + b, 0);
        const confidence = Math.round((maxScore / totalScore) * 100);

        // ê°€ì¥ ë†’ì€ ì ìˆ˜ì˜ ì–¸ì–´ ë°˜í™˜
        for (const [lang, score] of Object.entries(scores)) {
          if (score === maxScore) {
            const langCodes = {
              korean: `ko-KR (${confidence}%)`,
              japanese: `ja-JP (${confidence}%)`,
              chinese: `zh-CN (${confidence}%)`,
              english: `en-US (${confidence}%)`,
            };

            log(
              `ì–¸ì–´ ì ìˆ˜: í•œêµ­ì–´=${scores.korean}, ì¼ë³¸ì–´=${scores.japanese}, ì¤‘êµ­ì–´=${scores.chinese}, ì˜ì–´=${scores.english}`,
            );
            return langCodes[lang];
          }
        }

        return "ì •ë³´ ì—†ìŒ";
      }

      // í’ˆì§ˆ ì ìˆ˜ ê³„ì‚° í•¨ìˆ˜
      function calculateQualityScore(responseTime, confidence, textLength) {
        let score = 100;

        // ì‘ë‹µ ì‹œê°„ í‰ê°€ (ë¹ ë¥¼ìˆ˜ë¡ ì¢‹ìŒ)
        if (responseTime > 2000) score -= 30;
        else if (responseTime > 1000) score -= 15;
        else if (responseTime > 500) score -= 5;

        // ì‹ ë¢°ë„ í‰ê°€
        if (confidence) {
          if (confidence < 0.5) score -= 40;
          else if (confidence < 0.7) score -= 20;
          else if (confidence < 0.9) score -= 5;
        } else {
          score -= 20; // ì‹ ë¢°ë„ ì •ë³´ ì—†ìŒ
        }

        // í…ìŠ¤íŠ¸ ê¸¸ì´ í‰ê°€ (ë„ˆë¬´ ì§§ìœ¼ë©´ ì¸ì‹ í’ˆì§ˆ ì˜ì‹¬)
        if (textLength < 3) score -= 20;
        else if (textLength < 6) score -= 10;

        return Math.max(0, Math.round(score));
      }

      function clearLog() {
        document.getElementById("test-log").innerHTML = "";
        document.getElementById("interim-result").textContent = "";
        document.getElementById("final-result").textContent = "";
        totalRecognitionTime = 0;
        sessionStartTime = null;
        document.getElementById("total-time").textContent = "-";
        document.getElementById("speed").textContent = "-";
        document.getElementById("confidence").textContent = "-";
        document.getElementById("detected-lang").textContent = "-";
        document.getElementById("quality-score").textContent = "-";
      }

      // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¸Œë¼ìš°ì € ì§€ì› í™•ì¸
      window.onload = function () {
        checkBrowserSupport();
        log("í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ - Web Speech API í…ŒìŠ¤íŠ¸ ì¤€ë¹„ë¨");
      };
    </script>
  </body>
</html>
